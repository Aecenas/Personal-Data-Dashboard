import { AppLanguage } from './types';

type TranslationMap = Record<string, string>;
type TranslationParams = Record<string, string | number>;

const translations: Record<AppLanguage, TranslationMap> = {
  'en-US': {
    'common.all': 'All',
    'common.noData': 'No Data',
    'common.loading': 'Loading...',
    'common.save': 'Save',
    'common.back': 'Back',
    'common.next': 'Next',
    'sidebar.dashboard': 'Dashboard',
    'sidebar.recycleBin': 'Recycle Bin',
    'sidebar.settings': 'Settings',
    'dashboard.subtitle': 'Personal Data & Scripts Dashboard',
    'dashboard.doneEditing': 'Done Editing',
    'dashboard.refreshAll': 'Refresh All',
    'dashboard.editLayout': 'Edit Layout',
    'dashboard.addCard': 'Add Card',
    'dashboard.layoutEditHint':
      'Layout edit mode: click a card first, then use arrow keys to move it.',
    'dashboard.layoutEditSelected': 'Selected card: {title}',
    'dashboard.layoutEditNoSelection': 'No card selected in this group.',
    'dashboard.noMetricsInGroup': 'No metrics found in this group.',
    'dashboard.createFirstCard': 'Create your first card',
    'recycle.title': 'Recycle Bin',
    'recycle.description':
      'Manage deleted cards. Restore them to the dashboard or permanently delete them.',
    'recycle.clearBin': 'Clear Bin',
    'recycle.binEmpty': 'Bin is empty',
    'recycle.cardTitle': 'Card Title',
    'recycle.originalGroup': 'Original Group',
    'recycle.deletedAt': 'Deleted At',
    'recycle.actions': 'Actions',
    'recycle.restore': 'Restore',
    'recycle.deleteForever': 'Delete Forever',
    'recycle.permanentWarning': 'Items deleted forever cannot be recovered.',
    'recycle.confirmClear': 'Clear the recycle bin? This action cannot be undone.',
    'recycle.confirmDelete': 'Permanently delete this card?',
    'settings.title': 'Settings',
    'settings.description': 'Manage application preferences.',
    'settings.appearance': 'Appearance',
    'settings.theme': 'Theme',
    'settings.themeDesc': 'Select your preferred color scheme.',
    'settings.light': 'Light',
    'settings.dark': 'Dark',
    'settings.language': 'Language',
    'settings.languageDesc': 'Choose the language used across the application.',
    'settings.languageEnglish': 'English',
    'settings.languageChinese': 'Simplified Chinese',
    'settings.storage': 'Storage',
    'settings.dataLocation': 'Data Location',
    'settings.dataLocationDesc': 'Where your metrics configuration is stored.',
    'settings.changeFolder': 'Change Folder',
    'settings.resetToDefault': 'Reset to Default',
    'settings.pathChangeNote':
      'Note: Changing this will move your existing user_settings.json to the new location.',
    'settings.pythonRuntime': 'Python Runtime',
    'settings.defaultInterpreterPath': 'Default Interpreter Path (Optional)',
    'settings.defaultInterpreterDesc':
      'Leave empty to use system defaults (macOS/Linux: python3, Windows: python/py -3).',
    'settings.executionPriority': 'Execution priority',
    'settings.priorityCard': '1. Card-level interpreter path (if set)',
    'settings.priorityDefault': '2. Default interpreter path in settings (if set)',
    'settings.prioritySystem': '3. System default python command',
    'settings.scriptOutputFormat':
      'Script must output JSON to STDOUT: { "type": "scalar|series|status", "data": {...} }',
    'settings.selectDataFolder': 'Select Data Folder',
    'storage.path.default': 'Default (App Data Folder)',
    'storage.path.browser': 'Browser Memory',
    'cardShell.never': 'Never',
    'cardShell.refresh': 'Refresh',
    'cardShell.edit': 'Edit',
    'cardShell.delete': 'Delete',
    'cardShell.executionError': 'Execution Error',
    'cardShell.scriptExecutionFailed': 'Script execution failed',
    'cardShell.refreshing': 'Refreshing...',
    'exec.mappingScalarValueMissing': 'Mapping failed: scalar value not found ({path})',
    'exec.mappingXAxisNotArray': 'Mapping failed: x_axis is not an array ({path})',
    'exec.mappingSeriesNotArray': 'Mapping failed: series is not an array ({path})',
    'exec.mappingSeriesValuesNotArray': 'Mapping failed: series[{index}].values is not an array',
    'exec.mappingStatusLabelMissing': 'Mapping failed: status label not found ({path})',
    'exec.outputNotObject': 'Script output is not a valid JSON object',
    'exec.outputMissingType': 'Script output is missing type',
    'exec.outputMissingData': 'Script output is missing data',
    'exec.outputTypeMismatch': 'Script output type is {outputType}, but card type is {cardType}',
    'exec.notTauri': 'Current runtime is not Tauri; cannot run local Python scripts',
    'exec.timeout': 'Script timed out. Check script logic or increase timeout.',
    'exec.failedWithStderr': 'Script execution failed: {stderr}',
    'exec.failedWithExitCode': 'Script execution failed with exit code {code}',
    'exec.failedGeneric': 'Script execution failed',
    'exec.invalidJson': 'Script output is not valid JSON: {output}',
    'exec.validatePathRequired': 'Script path is required',
    'exec.validatePathExt': 'Script file must end with .py',
    'exec.validateBrowserOnly':
      'Browser mode performs basic validation only. Full validation requires the Tauri desktop app.',
    'wizard.selectPythonScript': 'Select Python Script',
    'wizard.step.info': 'Info',
    'wizard.step.source': 'Source',
    'wizard.step.mapping': 'Mapping',
    'wizard.step.test': 'Test',
    'wizard.editMetric': 'Edit Metric',
    'wizard.addMetric': 'Add New Metric',
    'wizard.subtitle': 'Configure your local Python script as a data source.',
    'wizard.cardTitle': 'Card Title',
    'wizard.cardTitlePlaceholder': 'e.g. GPU Temp',
    'wizard.group': 'Group',
    'wizard.groupPlaceholder': 'Default',
    'wizard.size': 'Size',
    'wizard.visualizationType': 'Visualization Type',
    'wizard.typeScalar': 'Scalar',
    'wizard.typeScalarDesc': 'Single value display',
    'wizard.typeSeries': 'Series',
    'wizard.typeSeriesDesc': 'Line or area chart',
    'wizard.typeStatus': 'Status',
    'wizard.typeStatusDesc': 'Health / state badge',
    'wizard.colorTheme': 'Color Theme',
    'wizard.colorDefault': 'Default',
    'wizard.colorBlue': 'Blue',
    'wizard.colorGreen': 'Green',
    'wizard.colorRed': 'Red',
    'wizard.colorYellow': 'Yellow',
    'wizard.colorPurple': 'Purple',
    'wizard.pythonScriptPath': 'Python Script Path',
    'wizard.pythonScriptPlaceholder': '/path/to/your/script.py',
    'wizard.browse': 'Browse',
    'wizard.scriptArgs': 'Script Args (space separated)',
    'wizard.scriptArgsPlaceholder': '--city beijing',
    'wizard.interpreterPathOptional': 'Interpreter Path (optional)',
    'wizard.interpreterPathPlaceholder': '/usr/bin/python3',
    'wizard.refreshInterval': 'Refresh Interval (seconds, 0 = disabled)',
    'wizard.timeout': 'Timeout (ms)',
    'wizard.refreshOnStart': 'Refresh on app start',
    'wizard.refreshOnResume': 'Refresh on app resume',
    'wizard.expectedOutput': 'Expected Output Format',
    'wizard.valueKey': 'Value Key',
    'wizard.unitKey': 'Unit Key',
    'wizard.trendKey': 'Trend Key',
    'wizard.colorKey': 'Color Key',
    'wizard.xAxisKey': 'X Axis Key',
    'wizard.seriesKey': 'Series Key',
    'wizard.seriesNameKey': 'Series Name Key',
    'wizard.seriesValuesKey': 'Series Values Key',
    'wizard.labelKey': 'Label Key',
    'wizard.stateKey': 'State Key',
    'wizard.messageKeyOptional': 'Message Key (optional)',
    'wizard.mappingHint': 'Mapping fields support dotted paths, for example metrics.cpu.value.',
    'wizard.clickRunTest': 'Click Run Test to generate preview',
    'wizard.testFailed': 'Test Failed',
    'wizard.scalarPreview': 'Scalar Preview',
    'wizard.seriesPreview': 'Series Preview',
    'wizard.statusPreview': 'Status Preview',
    'wizard.points': 'Points: {count}',
    'wizard.seriesCount': 'Series Count: {count}',
    'wizard.testAndPreview': 'Test & Preview',
    'wizard.runTest': 'Run Test',
    'wizard.running': 'Running...',
    'wizard.rawStdout': 'Raw STDOUT',
    'wizard.noOutputYet': 'No output yet',
    'wizard.stderr': 'STDERR',
    'wizard.testPassed': 'Test passed. You can save this card now.',
    'wizard.saveChanges': 'Save Changes',
    'wizard.createCard': 'Create Card',
    'wizard.validation.titleRequired': 'Please enter a card title',
    'wizard.validation.groupRequired': 'Please enter a group name',
    'wizard.validation.scriptPathRequired': 'Please enter a Python script path',
    'wizard.validation.scriptExt': 'Script file must end with .py',
    'wizard.validation.intervalMin': 'Refresh interval cannot be less than 0',
    'wizard.validation.timeoutMin': 'Timeout should be at least 1000ms',
    'wizard.validation.scalarValue': 'Scalar type requires a value key',
    'wizard.validation.seriesAxes': 'Series type requires x_axis key and series key',
    'wizard.validation.seriesFields': 'Series type requires name key and values key',
    'wizard.validation.statusFields': 'Status type requires label key and state key',
  },
  'zh-CN': {
    'common.all': '全部',
    'common.noData': '暂无数据',
    'common.loading': '加载中...',
    'common.save': '保存',
    'common.back': '返回',
    'common.next': '下一步',
    'sidebar.dashboard': '仪表盘',
    'sidebar.recycleBin': '回收站',
    'sidebar.settings': '设置',
    'dashboard.subtitle': '个人数据与脚本仪表盘',
    'dashboard.doneEditing': '完成编辑',
    'dashboard.refreshAll': '全部刷新',
    'dashboard.editLayout': '编辑布局',
    'dashboard.addCard': '添加卡片',
    'dashboard.layoutEditHint': '布局编辑模式：先点击卡片，再用方向键移动。',
    'dashboard.layoutEditSelected': '当前选中：{title}',
    'dashboard.layoutEditNoSelection': '当前分组没有可编辑的卡片。',
    'dashboard.noMetricsInGroup': '该分组暂无指标。',
    'dashboard.createFirstCard': '创建第一张卡片',
    'recycle.title': '回收站',
    'recycle.description': '管理已删除卡片。可恢复到仪表盘，或永久删除。',
    'recycle.clearBin': '清空回收站',
    'recycle.binEmpty': '回收站为空',
    'recycle.cardTitle': '卡片标题',
    'recycle.originalGroup': '原分组',
    'recycle.deletedAt': '删除时间',
    'recycle.actions': '操作',
    'recycle.restore': '恢复',
    'recycle.deleteForever': '永久删除',
    'recycle.permanentWarning': '被永久删除的项目无法恢复。',
    'recycle.confirmClear': '确认清空回收站吗？该操作不可撤销。',
    'recycle.confirmDelete': '确认彻底删除这张卡片吗？',
    'settings.title': '设置',
    'settings.description': '管理应用偏好配置。',
    'settings.appearance': '外观',
    'settings.theme': '主题',
    'settings.themeDesc': '选择你偏好的颜色主题。',
    'settings.light': '浅色',
    'settings.dark': '深色',
    'settings.language': '语言',
    'settings.languageDesc': '选择整个应用使用的语言。',
    'settings.languageEnglish': '英文',
    'settings.languageChinese': '简体中文',
    'settings.storage': '存储',
    'settings.dataLocation': '数据位置',
    'settings.dataLocationDesc': '指标配置文件的存储路径。',
    'settings.changeFolder': '更换目录',
    'settings.resetToDefault': '恢复默认',
    'settings.pathChangeNote': '注意：切换后会把现有 user_settings.json 迁移到新位置。',
    'settings.pythonRuntime': 'Python 运行时',
    'settings.defaultInterpreterPath': '默认解释器路径（可选）',
    'settings.defaultInterpreterDesc':
      '留空时使用系统默认命令（macOS/Linux: python3，Windows: python/py -3）。',
    'settings.executionPriority': '执行优先级',
    'settings.priorityCard': '1. 卡片级解释器路径（如设置）',
    'settings.priorityDefault': '2. 设置中的默认解释器路径（如设置）',
    'settings.prioritySystem': '3. 系统默认 python 命令',
    'settings.scriptOutputFormat':
      '脚本必须输出 JSON 到 STDOUT：{ "type": "scalar|series|status", "data": {...} }',
    'settings.selectDataFolder': '选择数据目录',
    'storage.path.default': '默认（应用数据目录）',
    'storage.path.browser': '浏览器内存',
    'cardShell.never': '从未',
    'cardShell.refresh': '刷新',
    'cardShell.edit': '编辑',
    'cardShell.delete': '删除',
    'cardShell.executionError': '执行错误',
    'cardShell.scriptExecutionFailed': '脚本执行失败',
    'cardShell.refreshing': '刷新中...',
    'exec.mappingScalarValueMissing': '字段映射失败：未找到 scalar value（{path}）',
    'exec.mappingXAxisNotArray': '字段映射失败：x_axis 不是数组（{path}）',
    'exec.mappingSeriesNotArray': '字段映射失败：series 不是数组（{path}）',
    'exec.mappingSeriesValuesNotArray': '字段映射失败：series[{index}].values 不是数组',
    'exec.mappingStatusLabelMissing': '字段映射失败：未找到 status label（{path}）',
    'exec.outputNotObject': '脚本输出不是有效 JSON 对象',
    'exec.outputMissingType': '脚本输出缺少 type 字段',
    'exec.outputMissingData': '脚本输出缺少 data 字段',
    'exec.outputTypeMismatch': '脚本输出类型为 {outputType}，与卡片类型 {cardType} 不一致',
    'exec.notTauri': '当前运行环境不是 Tauri，无法调用本地 Python 脚本',
    'exec.timeout': '脚本执行超时，请检查脚本逻辑或增大超时时间。',
    'exec.failedWithStderr': '脚本执行失败：{stderr}',
    'exec.failedWithExitCode': '脚本执行失败，退出码 {code}',
    'exec.failedGeneric': '脚本执行失败',
    'exec.invalidJson': '脚本输出不是合法 JSON：{output}',
    'exec.validatePathRequired': '脚本路径不能为空',
    'exec.validatePathExt': '脚本文件必须以 .py 结尾',
    'exec.validateBrowserOnly': '浏览器模式下仅做基础校验，完整校验需在 Tauri 桌面端进行',
    'wizard.selectPythonScript': '选择 Python 脚本',
    'wizard.step.info': '信息',
    'wizard.step.source': '来源',
    'wizard.step.mapping': '映射',
    'wizard.step.test': '测试',
    'wizard.editMetric': '编辑指标',
    'wizard.addMetric': '新增指标',
    'wizard.subtitle': '将本地 Python 脚本配置为数据源。',
    'wizard.cardTitle': '卡片标题',
    'wizard.cardTitlePlaceholder': '例如：GPU 温度',
    'wizard.group': '分组',
    'wizard.groupPlaceholder': '默认',
    'wizard.size': '尺寸',
    'wizard.visualizationType': '可视化类型',
    'wizard.typeScalar': '标量',
    'wizard.typeScalarDesc': '单值展示',
    'wizard.typeSeries': '序列',
    'wizard.typeSeriesDesc': '折线/面积图',
    'wizard.typeStatus': '状态',
    'wizard.typeStatusDesc': '健康状态徽标',
    'wizard.colorTheme': '颜色主题',
    'wizard.colorDefault': '默认',
    'wizard.colorBlue': '蓝色',
    'wizard.colorGreen': '绿色',
    'wizard.colorRed': '红色',
    'wizard.colorYellow': '黄色',
    'wizard.colorPurple': '紫色',
    'wizard.pythonScriptPath': 'Python 脚本路径',
    'wizard.pythonScriptPlaceholder': '/path/to/your/script.py',
    'wizard.browse': '浏览',
    'wizard.scriptArgs': '脚本参数（空格分隔）',
    'wizard.scriptArgsPlaceholder': '--city beijing',
    'wizard.interpreterPathOptional': '解释器路径（可选）',
    'wizard.interpreterPathPlaceholder': '/usr/bin/python3',
    'wizard.refreshInterval': '刷新间隔（秒，0 表示禁用）',
    'wizard.timeout': '超时时间（毫秒）',
    'wizard.refreshOnStart': '应用启动时刷新',
    'wizard.refreshOnResume': '应用恢复时刷新',
    'wizard.expectedOutput': '期望输出格式',
    'wizard.valueKey': 'Value 键',
    'wizard.unitKey': 'Unit 键',
    'wizard.trendKey': 'Trend 键',
    'wizard.colorKey': 'Color 键',
    'wizard.xAxisKey': 'X Axis 键',
    'wizard.seriesKey': 'Series 键',
    'wizard.seriesNameKey': 'Series Name 键',
    'wizard.seriesValuesKey': 'Series Values 键',
    'wizard.labelKey': 'Label 键',
    'wizard.stateKey': 'State 键',
    'wizard.messageKeyOptional': 'Message 键（可选）',
    'wizard.mappingHint': '映射字段支持点路径，例如 metrics.cpu.value。',
    'wizard.clickRunTest': '点击“运行测试”生成预览',
    'wizard.testFailed': '测试失败',
    'wizard.scalarPreview': '标量预览',
    'wizard.seriesPreview': '序列预览',
    'wizard.statusPreview': '状态预览',
    'wizard.points': '点数：{count}',
    'wizard.seriesCount': '序列数量：{count}',
    'wizard.testAndPreview': '测试与预览',
    'wizard.runTest': '运行测试',
    'wizard.running': '运行中...',
    'wizard.rawStdout': '原始 STDOUT',
    'wizard.noOutputYet': '暂无输出',
    'wizard.stderr': 'STDERR',
    'wizard.testPassed': '测试通过。现在可以保存这张卡片。',
    'wizard.saveChanges': '保存修改',
    'wizard.createCard': '创建卡片',
    'wizard.validation.titleRequired': '请填写卡片标题',
    'wizard.validation.groupRequired': '请填写分组名称',
    'wizard.validation.scriptPathRequired': '请填写 Python 脚本路径',
    'wizard.validation.scriptExt': '脚本文件必须是 .py',
    'wizard.validation.intervalMin': '刷新间隔不能小于 0',
    'wizard.validation.timeoutMin': '超时时间建议至少 1000ms',
    'wizard.validation.scalarValue': 'scalar 类型必须设置 value key',
    'wizard.validation.seriesAxes': 'series 类型必须设置 x_axis key 与 series key',
    'wizard.validation.seriesFields': 'series 类型必须设置 name key 与 values key',
    'wizard.validation.statusFields': 'status 类型必须设置 label key 与 state key',
  },
};

export const t = (
  language: AppLanguage,
  key: string,
  params: TranslationParams = {},
): string => {
  const template = translations[language][key] ?? translations['en-US'][key] ?? key;

  return Object.entries(params).reduce(
    (acc, [name, value]) => acc.replace(new RegExp(`\\{${name}\\}`, 'g'), String(value)),
    template,
  );
};
